// Code generated by ddbgen. DO NOT EDIT.

package example

import (
	"fmt"
	"github.com/acksell/bezos/dynamodb/ddbsdk"
	"github.com/acksell/bezos/dynamodb/index"
	"github.com/acksell/bezos/dynamodb/table"
)

// =============================================================================
// User Index Wrapper
// =============================================================================

// UserIndexType wraps the PrimaryIndex with strongly-typed methods.
type UserIndexType struct {
	index.PrimaryIndex
}

// UserIndex is the typed wrapper for User operations.
var UserIndex = UserIndexType{PrimaryIndex: *userIndex}

// PrimaryKey creates a strongly-typed primary key from explicit parameters.
func (idx UserIndexType) PrimaryKey(id string) table.PrimaryKey {
	return table.PrimaryKey{
		Definition: idx.Table.KeyDefinitions,
		Values: table.PrimaryKeyValues{
			PartitionKey: fmt.Sprintf("USER#%s", id),
			SortKey:      "PROFILE",
		},
	}
}

// PrimaryKeyFrom extracts the primary key from a User entity.
func (idx UserIndexType) PrimaryKeyFrom(e *User) table.PrimaryKey {
	return table.PrimaryKey{
		Definition: idx.Table.KeyDefinitions,
		Values: table.PrimaryKeyValues{
			PartitionKey: fmt.Sprintf("USER#%s", e.UserID),
			SortKey:      "PROFILE",
		},
	}
}

// NewUnsafePut creates a Put operation without optimistic locking.
func (idx UserIndexType) NewUnsafePut(e *User) *ddbsdk.Put {
	return ddbsdk.NewUnsafePut(idx.PrimaryIndex, idx.PrimaryKeyFrom(e), e)
}

// NewDelete creates a Delete operation.
func (idx UserIndexType) NewDelete(id string) *ddbsdk.Delete {
	return ddbsdk.NewDelete(idx.PrimaryIndex, idx.PrimaryKey(id))
}

// NewUnsafeUpdate creates an Update operation without optimistic locking.
func (idx UserIndexType) NewUnsafeUpdate(id string) *ddbsdk.UnsafeUpdate {
	return ddbsdk.NewUnsafeUpdate(idx.PrimaryIndex, idx.PrimaryKey(id))
}

// ByEmailKey creates a key for querying the ByEmail GSI.
func (idx UserIndexType) ByEmailKey(email string, id string) table.PrimaryKey {
	return table.PrimaryKey{
		Definition: idx.Secondary[0].KeyDefinition(),
		Values: table.PrimaryKeyValues{
			PartitionKey: fmt.Sprintf("EMAIL#%s", email),
			SortKey:      fmt.Sprintf("USER#%s", id),
		},
	}
}

// =============================================================================
// Order Index Wrapper
// =============================================================================

// OrderIndexType wraps the PrimaryIndex with strongly-typed methods.
type OrderIndexType struct {
	index.PrimaryIndex
}

// OrderIndex is the typed wrapper for Order operations.
var OrderIndex = OrderIndexType{PrimaryIndex: *orderIndex}

// PrimaryKey creates a strongly-typed primary key from explicit parameters.
func (idx OrderIndexType) PrimaryKey(tenantID string, orderID string) table.PrimaryKey {
	return table.PrimaryKey{
		Definition: idx.Table.KeyDefinitions,
		Values: table.PrimaryKeyValues{
			PartitionKey: fmt.Sprintf("TENANT#%s", tenantID),
			SortKey:      fmt.Sprintf("ORDER#%s", orderID),
		},
	}
}

// PrimaryKeyFrom extracts the primary key from a Order entity.
func (idx OrderIndexType) PrimaryKeyFrom(e *Order) table.PrimaryKey {
	return table.PrimaryKey{
		Definition: idx.Table.KeyDefinitions,
		Values: table.PrimaryKeyValues{
			PartitionKey: fmt.Sprintf("TENANT#%s", e.TenantID),
			SortKey:      fmt.Sprintf("ORDER#%s", e.OrderID),
		},
	}
}

// NewUnsafePut creates a Put operation without optimistic locking.
func (idx OrderIndexType) NewUnsafePut(e *Order) *ddbsdk.Put {
	return ddbsdk.NewUnsafePut(idx.PrimaryIndex, idx.PrimaryKeyFrom(e), e)
}

// NewDelete creates a Delete operation.
func (idx OrderIndexType) NewDelete(tenantID string, orderID string) *ddbsdk.Delete {
	return ddbsdk.NewDelete(idx.PrimaryIndex, idx.PrimaryKey(tenantID, orderID))
}

// NewUnsafeUpdate creates an Update operation without optimistic locking.
func (idx OrderIndexType) NewUnsafeUpdate(tenantID string, orderID string) *ddbsdk.UnsafeUpdate {
	return ddbsdk.NewUnsafeUpdate(idx.PrimaryIndex, idx.PrimaryKey(tenantID, orderID))
}
